%{
#include "Foo.h"
//MSH_include_begin
#include "MarshaledBar.h"
//MSH_include_end
%}

 marshaling class MarshaledFoo (Foo* param) {

    int x;
    //FIELDMARSHAL:
    {
	memcpy($$, &Shadowed_param->x, sizeof(int));
    }
    //FIELDUNMARSHAL:
    {
	memcpy(&Shadowed_param->x, $$, sizeof(int));

    }
    //FIELDSIZE:
    {
      $SIZE = sizeof(int);

    }

    Bar bar;
    //FIELDMARSHAL:
    {
	MarshaledBar var(&Shadowed_param->bar);
	memcpy($$, var.getBuffer(), var.getBufferSize());
    }
    //FIELDUNMARSHAL:
    {
	MarshaledBar var($$, 'u');
	var.unmarshalTo(&Shadowed_param->bar);

    }
    //FIELDSIZE:
    {
	MarshaledBar var(&Shadowed_param->bar);
	$SIZE = var.getBufferSize();

    }

    Bar* ptr;
    //FIELDMARSHAL:
    {
      memcpy( $$, &$varname, sizeof( int ));
    }
    //FIELDUNMARSHAL:
    {
      memcpy( &$varname, $$, sizeof( int ));
    }
    //FIELDSIZE:
    {
      $SIZE = sizeof( int );
    }
}

